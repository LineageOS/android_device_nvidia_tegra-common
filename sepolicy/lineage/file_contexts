# Copyright (C) 2018 The LineageOS Project
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Data files - TEE
/data/ss(/.*)?                                                                   u:object_r:tlk_data_file:s0
/data/tlk(/.*)?                                                                  u:object_r:tlk_data_file:s0

# Proc nodes
/proc/sys/kernel/printk                                                          u:object_r:proc_kernel:s0
/proc/sys/vm/min_free_kbytes                                                     u:object_r:proc_min_free_kbytes:s0
/proc/sys/vm/legacy_va_layout                                                    u:object_r:proc_legacy_va_layout:s0

# BCM Wi-Fi
/sys/firmware/devicetree/base/bcmdhd_wlan/status                                 u:object_r:sysfs_wlan_fwpath:s0
/sys/firmware/devicetree/base/chosen/proc-board/id                               u:object_r:sysfs_board:s0

# Source built HALs
/(vendor|system/vendor)/bin/hw/android\.hardware\.light@2\.0-service-nvidia      u:object_r:hal_light_default_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.health@2\.0-service\.tegra     u:object_r:hal_health_default_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.memtrack@1\.0-service-nvidia   u:object_r:hal_memtrack_default_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.power@1\.0-service-nvidia      u:object_r:hal_power_default_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.thermal@1\.0-service-nvidia    u:object_r:hal_thermal_default_exec:s0

# Prebuilt HALs
/(vendor|system/vendor)/lib(64)?/hw/audio\.primary\.tegra\.so                    u:object_r:same_process_hal_file:s0
/(vendor|system/vendor)/lib(64)?/hw/sound_trigger\.primary\.tegra\.so            u:object_r:same_process_hal_file:s0
